<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
          integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <style>
        .table{
            display: none;
        }

        .view{
            display: block;
        }
    </style>
    <title>Cheerio parsing</title>
</head>
<body>
<h1>Парсим данные с сайта 1A.ee - Все наушники в продаже</h1><br>
<button onclick="clickedCheerio()" type="button" id="btnCheerio" class="btn btn-danger">Парсить с помощью CHEERIO</button>
<button onclick="viewTable()" type="button" id="btnView" class="btn btn-danger">Показать данные</button>

<table id='table' class="table">
    <th>
        <tr>
            <th>№ продукта</th>
            <th>Название</th>
            <th>Цена</th>
            <th>Путь изображения</th>
            <th>Тип наушников</th>
            <th>Беспроводная связь</th>
            <th>Частотный диапазон</th>
            <th>Сопротивление</th>
            <th>Чувствительность</th>
        </tr>
    </th>
    <tbody></tbody>
</table>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="/socket.io/socket.io.js"></script>

<script>

    $(() => { //подключаем сокет с клиентской стороны
        const socket = io.connect();

        clickedCheerio = () => {
            socket.emit('clickedCheerio');
        };
        socket.on('savedFile', () => {
            alert('Файл 1aCheerio.json был сохранен на сервере');
        });
        socket.on('receiveObject', (data) => {
            drawTable(data);
        });
        drawTable = (data) => {
            for (let i = 0; i < data.length; i++) {
                drawRow(data[i], i);
            }
        };
        drawRow = (rowData, i) => {
            var row = $("<tr />")
            $("#table").append(row);
            row.append($("<td>" + (i + 1) + "</td>"));
            row.append($("<td>" + rowData.name + "</td>"));
            row.append($("<td>" + rowData.price + "</td>"));
            row.append($("<td>" + rowData.image + "</td>"));
            row.append($("<td>" + rowData.type + "</td>"));
            row.append($("<td>" + rowData.wireless + "</td>"));
            row.append($("<td>" + rowData.frequency + "</td>"));
            row.append($("<td>" + rowData.resistance + "</td>"));
            row.append($("<td>" + rowData.sensitivity + "</td>"));
        }


        viewTable = () => {
            let tbl = document.getElementById('table');
            if(tbl.rows.length==2){
                alert('Данные не получены');
            }else{
                tbl.classList.add("view");
            }
        }
    });

</script>
</body>
</html>